<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>Navegador con Pila y Cola</title>
</head>
<body>

<h1>Simulación de navegador</h1>

<select id="webs">
  <option value="google">Google</option>
  <option value="wikipedia">Wikipedia</option>
  <option value="github">GitHub</option>
</select>

<br><br>

<button id="abrir">Abrir web</button>
<button id="atras">⬅ Atrás</button>
<button id="adelante">➡ Adelante</button>

<h3>Web actual:</h3>
<pre id="actual">Ninguna</pre>

<h3>Saltos (cookie servidor):</h3>
<pre id="saltos">0</pre>

<h3>Historial atrás (PILA)</h3>
<pre id="historialAtras"></pre>

<h3>Historial adelante (COLA)</h3>
<pre id="historialAdelante"></pre>

<script>
/* =======================
   CLASE PILA (TU EJEMPLO)
   ======================= */
class Pila {
  #elementos;

  constructor() {
    this.#elementos = [];
  }

  push(elemento) {
    this.#elementos.push(elemento);
  }

  pop() {
    if (this.isEmpty()) return null;
    return this.#elementos.pop();
  }

  isEmpty() {
    return this.#elementos.length === 0;
  }

  mostrar() {
    if (this.isEmpty()) return "Pila vacía";
    let txt = "";
    for (let i = this.#elementos.length - 1; i >= 0; i--) {
      txt += this.#elementos[i] + "\n";
    }
    return txt;
  }
}

/* =======================
   CLASE COLA (FIFO)
   ======================= */
class Cola {
  #elementos;

  constructor() {
    this.#elementos = [];
  }

  enqueue(elemento) {
    this.#elementos.push(elemento);
  }

  dequeue() {
    if (this.isEmpty()) return null;
    return this.#elementos.shift();
  }

  isEmpty() {
    return this.#elementos.length === 0;
  }

  mostrar() {
    if (this.isEmpty()) return "Cola vacía";
    return this.#elementos.join("\n");
  }
}

/* =======================
   LÓGICA NAVEGADOR
   ======================= */
const pilaAtras = new Pila();
const colaAdelante = new Cola();

let webActual = null;

const sel = document.getElementById("webs");
const actual = document.getElementById("actual");
const saltos = document.getElementById("saltos");
const hAtras = document.getElementById("historialAtras");
const hAdelante = document.getElementById("historialAdelante");

async function abrirWeb(id, modo) {

  // si es selección manual → limpiar adelante
  if (modo === "manual") {
    colaAdelante = new Cola();
  }

  // pedir URL al servidor
  const res = await fetch(`get_url.php?site=${id}`);
  const data = await res.json();

  window.open(data.url, "_blank");

  // incrementar saltos
  const s = await fetch("jump.php", { method: "POST" });
  const js = await s.json();
  saltos.textContent = js.jumps;

  webActual = id;
  actual.textContent = id;

  hAtras.textContent = pilaAtras.mostrar();
  hAdelante.textContent = colaAdelante.mostrar();
}

document.getElementById("abrir").onclick = async () => {
  if (webActual !== null) pilaAtras.push(webActual);
  await abrirWeb(sel.value, "manual");
};

document.getElementById("atras").onclick = async () => {
  if (pilaAtras.isEmpty()) return;

  colaAdelante.enqueue(webActual);
  const anterior = pilaAtras.pop();
  await abrirWeb(anterior, "atras");
};

document.getElementById("adelante").onclick = async () => {
  if (colaAdelante.isEmpty()) return;

  pilaAtras.push(webActual);
  const siguiente = colaAdelante.dequeue();
  await abrirWeb(siguiente, "adelante");
};
</script>

</body>
</html>

