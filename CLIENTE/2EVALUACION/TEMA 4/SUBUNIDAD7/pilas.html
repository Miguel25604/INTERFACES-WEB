<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Simulador de Navegador</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        button { margin: 5px; }
        ul { margin-top: 10px; }
    </style>
</head>
<body>

<h2>üåê Navegador Simulado</h2>

<select id="webs">
    <option value="">-- Selecciona una web --</option>
    <option value="https://google.com">Google</option>
    <option value="https://wikipedia.org">Wikipedia</option>
    <option value="https://github.com">GitHub</option>
</select>

<button onclick="retroceder()">‚¨Ö Retroceder</button>
<button onclick="avanzar()">‚û° Avanzar</button>

<p><strong>Saltos dados:</strong> <span id="saltos">0</span></p>

<h3>üìö Historial completo (pila)</h3>
<ul id="historial"></ul>

<script>
/* =======================
   SERVIDOR (simulado)
======================= */
const servidor = {
    obtenerURL(web) {
        return web; // devuelve la URL solicitada
    },
    incrementarSaltos() {
        let saltos = Number(getCookie("saltos")) || 0;
        saltos++;
        document.cookie = `saltos=${saltos}`;
        return saltos;
    }
};

/* =======================
   CLIENTE
======================= */
let pilaHistorial = [];
let colaAdelante = [];
let popup = null;

document.getElementById("webs").addEventListener("change", e => {
    if (e.target.value) {
        abrirWeb(e.target.value, true);
        colaAdelante = []; // limpiar historial adelante
    }
});

function abrirWeb(web, guardarHistorial) {
    const url = servidor.obtenerURL(web);

    if (guardarHistorial && pilaHistorial.length > 0) {
        // no duplicar si es la misma
        if (pilaHistorial[pilaHistorial.length - 1] !== web) {
            pilaHistorial.push(web);
        }
    } else if (pilaHistorial.length === 0) {
        pilaHistorial.push(web);
    }

    if (popup && !popup.closed) popup.close();
    popup = window.open(url, "_blank", "width=600,height=400");

    const saltos = servidor.incrementarSaltos();
    document.getElementById("saltos").textContent = saltos;

    actualizarHistorial();
}

function retroceder() {
    if (pilaHistorial.length <= 1) return;

    const actual = pilaHistorial.pop();
    colaAdelante.unshift(actual);

    abrirWeb(pilaHistorial[pilaHistorial.length - 1], false);
}

function avanzar() {
    if (colaAdelante.length === 0) return;

    const siguiente = colaAdelante.shift();
    pilaHistorial.push(siguiente);

    abrirWeb(siguiente, false);
}

function actualizarHistorial() {
    const ul = document.getElementById("historial");
    ul.innerHTML = "";
    pilaHistorial.forEach(web => {
        const li = document.createElement("li");
        li.textContent = web;
        ul.appendChild(li);
    });
}

/* =======================
   COOKIES
======================= */
function getCookie(nombre) {
    const cookies = document.cookie.split("; ");
    for (let c of cookies) {
        const [key, value] = c.split("=");
        if (key === nombre) return value;
    }
    return null;
}
</script>

</body>
</html>
